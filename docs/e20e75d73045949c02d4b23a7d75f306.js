require=function(r,e,n){function t(n,o){function i(r){return t(i.resolve(r))}function f(e){return r[n][1][e]||e}if(!e[n]){if(!r[n]){var c="function"==typeof require&&require;if(!o&&c)return c(n,!0);if(u)return u(n,!0);var l=new Error("Cannot find module '"+n+"'");throw l.code="MODULE_NOT_FOUND",l}i.resolve=f;var a=e[n]=new t.Module;r[n][0].call(a.exports,i,a,a.exports)}return e[n].exports}function o(){this.bundle=t,this.exports={}}var u="function"==typeof require&&require;t.Module=o,t.modules=r,t.cache=e,t.parent=u;for(var i=0;i<n.length;i++)t(n[i]);return t}({3:[function(require,module,exports) {
const e=1e3,t=600,n=200,r=20,i=80,o=.25,a=-7,s=9,l=150,h=400,f=64,c=-4,u=4,y=document.getElementById("canvas"),d=y.getContext("2d");y.width=e,y.height=t;let x=[],p=[],b=!0,m=0,g=0,v=null,S=null;function k(){if(0===x.filter(e=>e.alive).length&&(m=0,B(),J()),m++,p.forEach(e=>{e.x+=c}),p.length>1&&p[0].x<.5*-f){let e=p.shift();e.x=p[p.length-1].x+h,e.y=Math.random()*(.7*t)+.15*t,p.push(e)}const n=p[0].x>i?p[0]:p[1];x.forEach(r=>{if(!r.alive)return;r.dy+=o,r.dy>s&&(r.dy=s),r.y+=r.dy,(r.y<0||r.y>t||M(r))&&(r.fitness=m-Math.abs(r.y-n.y),r.alive=!1);let i=(n.x-r.x)/e,l=(n.y-r.y+t)/(2*t);r.brain.activate([i,l])>.5&&(r.dy=a)}),E(),b&&requestAnimationFrame(k)}function M(e){for(let t=0;t<2;++t){let n=p[t];return!(e.x-e.r>n.x+.5*f||n.x-.5*f>e.x+e.r)&&(e.y-e.r<n.y-.5*l||e.y+e.r>n.y+.5*l)}}function E(){d.clearRect(0,0,e,t),d.lineWidth=3,x.forEach(e=>{e.alive&&(d.strokeStyle="hsl("+e.hue+", 50%, 50%)",d.fillStyle="hsl("+e.hue+", 50%, 25%)",d.beginPath(),d.arc(e.x,e.y,e.r,0,6.28),d.closePath(),d.fill(),d.stroke())}),p.forEach(e=>{d.save(),d.translate(e.x,e.y),d.strokeStyle="hotpink",d.fillStyle="#223",d.beginPath(),d.rect(.5*-f,-t-.5*l,f,t),d.rect(.5*-f,.5*l,f,t),d.closePath(),d.fill(),d.stroke(),d.beginPath(),d.moveTo(-4,-4),d.lineTo(4,4),d.moveTo(-4,4),d.lineTo(4,-4),d.closePath(),d.stroke(),d.restore()}),d.fillStyle="white",d.font="12px sans-serif",d.textBaseline="top",d.fillText("Alive: "+x.filter(e=>e.alive).length,10,10),d.fillText("Score: "+m,10,30),S&&d.fillText("Best Ever: "+S.fitness.toFixed(1),10,50),v&&d.fillText("Gen "+g+" Best: "+v.fitness.toFixed(1),10,70)}function N(){x=[];for(let e=0;e<n;++e)x.push(w())}function w(e){return{x:i,y:Math.random()*t/2+t/4,dy:0,ddy:0,r:8,hue:Math.round(360*Math.random()),alive:!0,brain:e||T(),fitness:0}}function T(){let e=new synaptic.Architect.Perceptron(2,5,1).toJSON();return e.connections.forEach(e=>e.weight=Math.random()-.5),e.neurons.forEach(e=>e.bias=Math.random()-.5),synaptic.Network.fromJSON(e)}function J(){if(g++,0===x.length)return N();let e=x.slice().sort((e,t)=>t.fitness-e.fitness).slice(0,r);for(v=e[0],(!S||S.fitness<e[0].fitness)&&(S=e[0]),x=[],e.forEach(t=>{x.push(w(S.brain)),x.push(w(t.brain)),x.push(w(O(t.brain))),x.push(w(P(e[0].brain,t.brain))),x.push(w(P(e[1].brain,t.brain)))});x.length<n;)x.push(w())}function O(e){e=e.toJSON();for(let t=0;t<e.neurons.length;++t)Math.random()<.2&&(e.neurons[t].bias*=3*(Math.random()-.5));return synaptic.Network.fromJSON(e)}function P(e,t){e=e.toJSON(),t=t.toJSON();for(let n=0;n<e.neurons.length;++n)if(Math.random()<.2){let r=t.neurons[n].bias;t.neurons[n].bias=e.neurons[n].bias,e.neurons[n].bias=r}return synaptic.Network.fromJSON(Math.random()>.5?e:t)}function B(){p=[];for(let n=0;n<u;++n)p.push({x:.75*e+n*h,y:Math.random()*(.7*t)+.15*t,gap:l})}function A(e){e.repeat||(" "===e.key&&x.forEach(e=>e.y=-100),e.key)}k(),window.addEventListener("keypress",A);
},{}]},{},[3])